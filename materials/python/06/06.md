# NumPyについて
QGISに限らずラスターデータを扱う際には、ラスターデータの各ピクセル値を一旦、配列に格納した上で、各ピクセル値にアクセスしていくことになります。
Pythonで配列を扱う際には、数値計算ライブラリであるNumPyを使用すると便利です。
実際にラスターデータにアクセスする前に、NumPyの基本的な機能を触ってみましょう。

**Menu**
------
- [NumPyのインポート](#NumPyのインポート)
- [配列の基礎](#配列の基礎)
- [配列の四則演算](#配列の四則演算)
- [条件に合致するインデックスの取得](#条件に合致するインデックスの取得)
- [NumPyのリファレンス](#NumPyのリファレンス)

## <a name="NumPyのインポート"></a>NumPyのインポート
QGISのPythonコンソールでNumPyを使うには、まずNumPyをインポートします。

```Python
>>>import numpy as np
```

## <a name="配列の基礎"></a>配列の基礎
まずは、1次元の配列AをNumPyを使って作ります。
NumPyでは`ndarray`オブジェクトを使って以下のようにして作成することができます。

```Python
>>>A = np.array([1, 2, 3])
>>>A
array([1, 2, 3])
```

同様にして、2次元の配列Bを作ります。
2次元配列は`[ ]`を入れ子にして表現します。

```Python
>>>B = np.array([[1, 2], [3, 4]])
>>>B
array([[1, 2],
       [3, 4]])
```

同様にして3次元以上の配列は`[ ]`を入れ子にすることで次元を拡張して作ることができます。

各要素はインデックスを指定して、配列の各要素を取得することができます。

```Python
>>>B[0][0]
1
>>>B[1][0]
3
```

## <a name="配列の四則演算"></a>配列の四則演算
配列のオブジェクト、`ndarray`の要素は配列同様に加減乗除ができます。
配列の全ての要素に+1します。

```Python
>>>C = B + 1
>>>C
array([[2, 3],
       [4, 5]])
```

配列の全ての要素に-3します。

```Python
>>>D = B - 3
>>>D
array([[-2, -1],
	[0, 1]])
```

配列の全ての要素に*6します。

```Python
>>>E = B * 6
>>>E
array([[ 6, 12],
       [18, 24]])
```

配列の全ての要素に/3します。

```Python
>>>F = B / 3
>>>F
array([[0.33333333, 0.66666667],
       [1.        , 1.33333333]])
```

配列同士の加減乗除を行うこともできます。

```Python
>>>G = E + F
>>>G
array([[ 6.33333333, 12.66666667],
       [19.        , 25.33333333]])
```

## <a name="条件に合致するインデックスの取得"></a>条件に合致するインデックスの取得
`np.where()`を使用すると、条件に合致したインデックスを取得できます。
値が20より小さい要素のインデックスを取得してみましょう。

```Python
>>>np.where(G<20)
(array([0, 0, 1], dtype=int64), array([0, 1, 0], dtype=int64)
```

配列が2つ返ってきます。
２つを組み合わせたインデックス`(0, 0)` `(0, 1)` `(1, 0)`が条件に合致したインデックスになります。

`np.where()`の第二引数に条件を満たした場合の値、第三引数に条件を満たさなかった値を指定して、指定した値を入れた新たな配列を返すこともできます。

```Python
>>>np.where(G<20, 1, 0)
array([[1, 1],
       [1, 0]])
```

## <a name="NumPyのリファレンス"></a>NumPyのリファレンス
上記以外のNumPyライブラリの扱い方や操作方法は、[NumPy公式ドキュメント]を参照ください。

[NumPy公式ドキュメント]:http://www.numpy.org/

<h2 style="background-color:#F8F5FD;text-align:center;">教材の利用に関するアンケート</h2>　本プロジェクトでは、教材の改良を目的とした任意アンケートを実施しています。ご協力いただける方は、<a href="https://docs.google.com/forms/d/1r8RTFK3CPo4xNM6SdOEsAtdA0CrChD6KPVVU9kRxWRs/">アンケート</a>にお進みください。ご協力のほどよろしくお願いいたします。<br><br>※ 本アンケートの成果は、教材の改良のほか、学会での発表等の研究目的でも利用します。
